trigger:
  - main
  
resources:
  - repo: self

variables:
  tag: '$(Build.BuildId)'
  imageName: 'public-api'
  vmImageName: ubuntu-latest
  
stages: # jobs GA
  - stage: Build
    displayName: Build Image
    jobs:   # steps GA
      - job: Build
        displayName: Build
        pool:
          vmImage: $(vmImageName)

        steps:
          - task: Docker@2
            displayName: Build an image
            inputs:
              repository: $(imageName)
              command: build
              dockerfile: '**/qa.dockerfile'
              tags: |
                $(tag)

